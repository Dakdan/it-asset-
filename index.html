<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>IT UDH Maintenance & Service</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:linear-gradient(135deg,#ff5fa2,#ffd1e6);
}
.container{
  max-width:420px;
  margin:40px auto;
  background:#fff;
  border-radius:20px;
  padding:20px;
  border:3px solid #ff5fa2;
}
h1{
  text-align:center;
  color:#ff2f92;
}
.input{
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:10px;
  border:1px solid #ff5fa2;
  font-size:16px;
}
button{
  width:100%;
  padding:14px;
  background:#ff2f92;
  color:#fff;
  border:none;
  border-radius:14px;
  font-size:18px;
}
button:hover{opacity:0.9;}
</style>
</head>

<body>
<div class="container">
  <h1>üñ•Ô∏è IT SERVICE DESK</h1>

  <select id="jobType" class="input">
    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô</option>
  </select>

  <select id="jobSubType" class="input">
    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏á‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏¢</option>
  </select>

  <textarea id="detail" class="input" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô / ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏±‡∏ç‡∏´‡∏≤"></textarea>
  <input id="phone" class="input" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö">
  <input id="reporter" class="input" placeholder="‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á">

  <button onclick="submitJob()">üîí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏à‡πâ‡∏á‡∏á‡∏≤‡∏ô</button>
</div>

<script>
function loadJobTypes(){
  google.script.run.withSuccessHandler(data=>{
    const sel=document.getElementById("jobType");
    data.forEach(d=>{
      const o=document.createElement("option");
      o.value=d.code;
      o.text=d.name;
      sel.appendChild(o);
    });
  }).getJobTypes();
}

document.getElementById("jobType").onchange=function(){
  const code=this.value;
  const sub=document.getElementById("jobSubType");
  sub.innerHTML='<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏á‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏¢</option>';
  if(!code) return;

  google.script.run.withSuccessHandler(data=>{
    data.forEach(d=>{
      const o=document.createElement("option");
      o.value=d.code;
      o.text=d.name;
      sub.appendChild(o);
    });
  }).getJobSubTypes(code);
};

function submitJob(){
  const form={
    jobType:jobType.value,
    jobSubType:jobSubType.value,
    detail:detail.value,
    phone:phone.value,
    reporter:reporter.value
  };

  google.script.run.withSuccessHandler(id=>{
    alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏á‡∏≤‡∏ô: "+id);
    location.reload();
  }).saveJob(form);
}

loadJobTypes();
</script>
</body>
</html>

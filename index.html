<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>IT Service Desk</title>
<style>
body {
  font-family: Arial;
  background: linear-gradient(135deg,#ff6aa2,#ffffff);
}
.container {
  max-width: 420px;
  margin: auto;
  background: white;
  border-radius: 16px;
  padding: 16px;
  border: 2px solid #ff6aa2;
}
.logo {
  text-align: center;
  font-size: 22px;
  font-weight: bold;
  color: #ff2f92;
}
input, select, textarea {
  width: 100%;
  margin-top: 8px;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #ff6aa2;
}
button {
  margin-top: 12px;
  width: 100%;
  padding: 12px;
  border-radius: 10px;
  border: none;
  background: #ff2f92;
  color: white;
  font-size: 16px;
}
</style>
</head>

<body>
<div class="container">
  <div class="logo">üñ•Ô∏è IT SERVICE DESK</div>

  <select id="jobType"></select>
  <select id="jobSubType"></select>

  <textarea id="detail" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤"></textarea>
  <input id="contact" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö">
  <input id="reporter" placeholder="‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á">

  <button onclick="save()">üì® ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏à‡πâ‡∏á‡∏á‡∏≤‡∏ô</button>
</div>

<script>
google.script.run.withSuccessHandler(t=>{
  jobType.innerHTML='<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô</option>';
  t.forEach(r=>{
    jobType.innerHTML+=`<option value="${r[1]}">${r[1]}</option>`;
  });
}).getJobType();

let subTypeData=[];
google.script.run.withSuccessHandler(d=>subTypeData=d).getJobSubType();

jobType.onchange=()=>{
  jobSubType.innerHTML='<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏á‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏¢</option>';
  subTypeData.filter(r=>r[0]==jobType.value)
    .forEach(r=>{
      jobSubType.innerHTML+=`<option>${r[2]}</option>`;
    });
};

function save(){
  google.script.run.saveJob({
    jobType:jobType.value,
    jobSubType:jobSubType.value,
    detail:detail.value,
    contact:contact.value,
    reporter:reporter.value
  });
  alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
}
</script>
</body>
</html>

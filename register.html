<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô IT - ‡∏£‡∏û.‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ</title>
    <link rel="stylesheet" href="style.css?v=1.0">
</head>
<body>
    <div id="loader" class="loader-overlay" style="display: none;"><div class="spinner"></div></div>

    <div class="login-wrapper">
        <div class="login-header">
            <img src="https://img2.pic.in.th/-227e4f6f84f29f020.png" class="header-logo">
            <h2>‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ</h2>
            <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà IT</p>
        </div>

        <div class="login-card">
            <div class="form-group">
                <label>üÜî USERID</label>
                <input type="text" id="USERID" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
            </div>

            <div class="form-group">
                <label>üìß UserMail</label>
                <input type="email" id="UserMail" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
            </div>

            <div class="form-group">
                <label>üë§ UserName</label>
                <input type="text" id="UserName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á">
            </div>

            <div class="form-group">
                <label>üë• UserSname</label>
                <input type="text" id="UserSname" placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
            </div>

            <div class="form-group">
                <label>üíº UserTypeName</label>
                <select id="UserTypeName">
                    <option value="‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå">‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</option>
                    <option value="‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå">‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</option>
                    <option value="‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô IT">‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô IT</option>
                </select>
            </div>

            <button onclick="handleRegister()" class="btn-login" id="submitBtn">üì© ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏°‡∏•</button>
            <button onclick="window.location.replace('login.html')" class="btn-back">‚¨ÖÔ∏è ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</button>
        </div>
    </div>

    <script>
        // *** ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ Deploy ‡πÅ‡∏ö‡∏ö Anyone ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ***
        const SCRIPT_URL = "URL_‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å_GOOGLE_APPS_SCRIPT"; 

        async function handleRegister() {
            const submitBtn = document.getElementById('submitBtn');
            const loader = document.getElementById('loader');

            // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏≤‡∏° ID ‡∏ó‡∏µ‡πà‡∏™‡∏∞‡∏Å‡∏î‡∏ï‡∏≤‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á ITUser
            const payload = {
                action: 'registerIT',
                USERID: document.getElementById('USERID').value,
                UserMail: document.getElementById('UserMail').value,
                UserName: document.getElementById('UserName').value,
                UserSname: document.getElementById('UserSname').value,
                UserTypeName: document.getElementById('UserTypeName').value
            };

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á
            if(!payload.USERID || !payload.UserMail || !payload.UserName) {
                alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (USERID, Email, ‡∏ä‡∏∑‡πà‡∏≠) ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô");
                return;
            }

            // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏•‡πá‡∏≠‡∏Ñ‡∏õ‡∏∏‡πà‡∏°
            loader.style.display = 'flex';
            submitBtn.disabled = true;

            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    body: JSON.stringify(payload)
                });
                
                const result = await response.json();

                if (result.success) {
                    alert("‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (UserPW) ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏≠‡∏µ‡πÄ‡∏°‡∏• " + payload.UserMail + " ‡πÅ‡∏•‡πâ‡∏ß");
                    window.location.replace('login.html');
                } else {
                    alert("‚ùå ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÅ‡∏à‡πâ‡∏á‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + (result.error || "‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏"));
                }
            } catch (error) {
                console.error(error);
                alert("‚ùå ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Deployment ‡πÉ‡∏ô Google Script ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô 'Anyone' ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á?");
            } finally {
                loader.style.display = 'none';
                submitBtn.disabled = false;
            }
        }
    </script>
</body>
</html>

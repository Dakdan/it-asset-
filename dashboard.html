<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8">
<title>Dashboard</title>
<script src="config.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
<h2>Dashboard</h2>
<canvas id="chart"></canvas>
<br>
<button onclick="logout()">Logout</button>

<script>
const user = JSON.parse(sessionStorage.getItem("user"));
if(!user) location.href="index.html";

fetch(GAS_API + "?action=dashboard")
.then(r=>r.json())
.then(data=>{
  new Chart(document.getElementById("chart"),{
    type:"bar",
    data:{
      labels:Object.keys(data),
      datasets:[{
        label:"จำนวนครุภัณฑ์",
        data:Object.values(data)
      }]
    }
  });
});

function logout(){
  sessionStorage.clear();
  location.href="index.html";
}
</script>
</body>
</html>
